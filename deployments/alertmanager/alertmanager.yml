# AlertManager configuration for NTPU LINE Bot
global:
  resolve_timeout: 5m

route:
  receiver: 'default'
  group_by: ['alertname']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 12h
  routes:
    - receiver: 'critical'
      matchers:
        - severity = "critical"
    - receiver: 'warning'
      matchers:
        - severity = "warning"
    - receiver: 'info'
      matchers:
        - severity = "info"

receivers:
  - name: 'default'
  - name: 'critical'
    # webhook_configs:
    #   - url: 'http://your-webhook/critical'
  - name: 'warning'
  - name: 'info'

inhibit_rules:
  # Suppress all when service is down
  - source_matchers:
      - alertname = "ServiceDown"
    target_matchers:
      - severity =~ "warning|info"
  # Suppress warning when critical
  - source_matchers:
      - severity = "critical"
    target_matchers:
      - severity = "warning"
    equal: ['alertname']
  # Suppress info when warning/critical
  - source_matchers:
      - severity =~ "warning|critical"
    target_matchers:
      - severity = "info"
    equal: ['alertname']
