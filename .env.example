# LINE Bot Configuration
# Required environment variables for NTPU LineBot

# LINE Channel Access Token
# Get this from LINE Developer Console > Your Channel > Messaging API
LINE_CHANNEL_ACCESS_TOKEN=your_access_token_here

# LINE Channel Secret
# Get this from LINE Developer Console > Your Channel > Basic settings
LINE_CHANNEL_SECRET=your_channel_secret_here

# GenAI Configuration (Optional)
# Get this from Google AI Studio: https://aistudio.google.com/apikey
# Enables AI features:
#   1. NLU intent parsing - Natural language understanding for unmatched messages
#   2. Query Expansion - Enhances search queries with synonyms and translations
GEMINI_API_KEY=your_gemini_api_key_here

# Server Configuration
PORT=10000                      # HTTP server port
LOG_LEVEL=info                  # Log level: debug, info, warn, error
SHUTDOWN_TIMEOUT=30s            # Graceful shutdown timeout (supports: s, m, h)

# Data Configuration
# Windows 本機開發: ./data
# Linux/Mac 本機開發: /data (或 ./data)
# Docker 容器: /data (固定)
# 檔案會自動建立在此目錄下:
#   - cache.db (SQLite 資料庫)
DATA_DIR=/data                  # Data directory path
CACHE_TTL=168h                  # Cache time-to-live (7 days)

# Scraper Configuration
SCRAPER_TIMEOUT=60s             # HTTP request timeout per request (supports: s, m)
SCRAPER_MAX_RETRIES=5           # Maximum retry attempts with exponential backoff
                                # Success: fixed 2s delay before next request
                                # Failure: 4s → 8s → 16s → 32s → 64s (±25% jitter)

# Warmup Configuration (Background warmup on server startup)
WARMUP_MODULES=sticker,id,contact,course # Modules to warmup (comma-separated)
                                         # Add "syllabus" to enable syllabus warmup (requires GEMINI_API_KEY)
                                         # Empty string to skip warmup

# Webhook Configuration
WEBHOOK_TIMEOUT=60s             # Timeout for webhook bot processing (default: 60s)
                                # Set to 60s because:
                                # - LINE loading animation shows for up to 60s
                                # - Smart search operations may take significant time
                                # - Maximizes available processing time within LINE's limits

# Rate Limit Configuration (Per-user)
# USER_RATE_LIMIT_TOKENS=6.0    # Max tokens per user (default: 6)
# USER_RATE_LIMIT_REFILL_RATE=0.2 # Token refill rate per second (default: 1/5 = 0.2)
                                # With defaults: 6 tokens, refills 1 token every 5 seconds
